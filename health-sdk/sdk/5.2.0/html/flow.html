

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Flow &mdash; Gini Health SDK for Android  documentation</title>
  

  
  

  
  <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,400italic,600italic|Source+Code+Pro|Roboto+Slab:400,700" rel="stylesheet" type="text/css" />

  
  

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'./',
        VERSION:'',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  true
      };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>

    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
    <script type="text/javascript">
        jQuery(function () {
            SphinxRtdTheme.StickyNav.enable();
        });
    </script>
  

  
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Gini Health SDK for Android  documentation" href="index.html"/>
        <link rel="next" title="Event Tracking" href="event-tracking.html"/>
        <link rel="prev" title="Authentication" href="authentication.html"/> 

  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" id="gini-logo">
          <img src="_static/logo_flat.png" />
        </a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="setup.html">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="setup.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html#gini-pay-deep-link-for-your-app">Gini Pay Deep Link For Your App</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html#gini-health-api-client-credentials">Gini Health API Client Credentials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="authentication.html">Authentication</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Flow</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#create-the-ginihealth-instance">Create the GiniHealth instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#upload-documents">Upload documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="#delete-multiple-documents-at-once">Delete multiple documents at once</a></li>
<li class="toctree-l2"><a class="reference internal" href="#check-which-documents-invoices-are-payable">Check which documents/invoices are payable</a></li>
<li class="toctree-l2"><a class="reference internal" href="#check-if-document-has-multiple-invoices">Check if document has multiple invoices</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-the-paymentfragment">Create the PaymentFragment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="event-tracking.html">Event Tracking</a><ul>
<li class="toctree-l2"><a class="reference internal" href="event-tracking.html#ginihealth">GiniHealth</a></li>
<li class="toctree-l2"><a class="reference internal" href="event-tracking.html#paymentcomponent">PaymentComponent</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="testing.html#requirements">Requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="testing.html#example-banking-app">Example banking app</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing.html#development-gini-health-api-client-credentials">Development Gini Health API client credentials</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="testing.html#end-to-end-testing">End to end testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="testing.html#id1">Example banking app</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing.html#payment-fragment">Payment Fragment</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing.html#payment-component-bottom-sheet">Payment component bottom sheet</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing.html#bank-picker">Bank picker</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing.html#more-information-and-faq">More information and FAQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing.html#payment-review">Payment review</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing.html#execute-payment">Execute payment</a></li>
<li class="toctree-l3"><a class="reference internal" href="testing.html#return-to-your-app">Return to your app</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="testing.html#testing-in-production">Testing in production</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="customization.html">UI Customization Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="customization.html#overview-of-ui-customization-options">Overview of UI customization options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="customization.html#styles">Styles</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#colors">Colors</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#images">Images</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#typography">Typography</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#text">Text</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#dark-mode">Dark mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="customization.html#ui-customization-options">UI customization options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="customization.html#payment-component">Payment Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#bank-selection-bottom-sheet">Bank Selection Bottom Sheet</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#payment-feature-info-screen">Payment Feature Info Screen</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#payment-review-screen">Payment Review Screen</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data-safety.html">Google Play Data Safety Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data-safety.html#data-collection-and-security">Data collection and security</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-safety.html#data-types">Data types</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-safety.html#data-usage-and-handling">Data usage and handling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="data-safety.html#financial-info-purchase-history">Financial info - Purchase history</a></li>
<li class="toctree-l3"><a class="reference internal" href="data-safety.html#photos-and-videos">Photos and videos</a></li>
<li class="toctree-l3"><a class="reference internal" href="data-safety.html#files-and-docs">Files and docs</a></li>
<li class="toctree-l3"><a class="reference internal" href="data-safety.html#device-or-other-ids">Device or other IDs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Reference Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a><ul>
<li class="toctree-l2"><a class="reference internal" href="license.html#licenses-and-acknowledgements-for-incorporated-software">Licenses and Acknowledgements for Incorporated Software</a><ul>
<li class="toctree-l3"><a class="reference internal" href="license.html#photoview">PhotoView</a></li>
<li class="toctree-l3"><a class="reference internal" href="license.html#insetter">Insetter</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Gini Health SDK for Android</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Flow</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="flow">
<h1>Flow<a class="headerlink" href="#flow" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">GiniHealth</span></code> and <code class="docutils literal notranslate"><span class="pre">PaymentFragment</span></code> are the main classes for interacting with the Gini Health SDK. <code class="docutils literal notranslate"><span class="pre">GiniHealth</span></code>
manages interaction with the Gini Health API and <code class="docutils literal notranslate"><span class="pre">PaymentFragment</span></code> controls the payment flow and the displayed screens.</p>
<div class="contents local topic" id="the-recommended-flow-is">
<p class="topic-title">The recommended flow is:</p>
<ul class="simple">
<li><a class="reference internal" href="#create-the-ginihealth-instance" id="id1">Create the GiniHealth instance</a></li>
<li><a class="reference internal" href="#upload-documents" id="id2">Upload documents</a></li>
<li><a class="reference internal" href="#delete-multiple-documents-at-once" id="id3">Delete multiple documents at once</a></li>
<li><a class="reference internal" href="#check-which-documents-invoices-are-payable" id="id4">Check which documents/invoices are payable</a></li>
<li><a class="reference internal" href="#check-if-document-has-multiple-invoices" id="id5">Check if document has multiple invoices</a></li>
<li><a class="reference internal" href="#create-the-paymentfragment" id="id6">Create the PaymentFragment</a></li>
</ul>
</div>
<div class="section" id="create-the-ginihealth-instance">
<h2><a class="toc-backref" href="#id1">Create the GiniHealth instance</a><a class="headerlink" href="#create-the-ginihealth-instance" title="Permalink to this headline">¶</a></h2>
<p>Before creating an instance of <code class="docutils literal notranslate"><span class="pre">GiniHealth</span></code> you need to create an instance of the <code class="docutils literal notranslate"><span class="pre">GiniHealthAPI</span></code>. The Gini Health
SDK provides the following two helper methods for creating the  <code class="docutils literal notranslate"><span class="pre">GiniHealthAPI</span></code> instance:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">getGiniApi(context:</span> <span class="pre">Context,</span> <span class="pre">clientId:</span> <span class="pre">String,</span> <span class="pre">clientSecret:</span> <span class="pre">String,</span> <span class="pre">emailDomain:</span> <span class="pre">String)</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">getGiniApi(context:</span> <span class="pre">Context,</span> <span class="pre">sessionManager:</span> <span class="pre">SessionManager)</span></code></li>
</ul>
<p>After that you can create an instance of <code class="docutils literal notranslate"><span class="pre">GiniHealth</span></code>:</p>
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="py">giniHealth</span> <span class="p">=</span> <span class="n">GiniHealth</span><span class="p">(</span><span class="n">giniHealthApi</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">GiniHealth</span></code> exposes a method for loading payment providers manually: <code class="docutils literal notranslate"><span class="pre">giniHealth.loadPaymentProviders()</span></code>.</p>
<p>Although <code class="docutils literal notranslate"><span class="pre">GiniHealth</span></code> loads the payment providers when it is instantiated, this method can be used if there was an error when loading the payment providers, as a manual retry mechanism. If <code class="docutils literal notranslate"><span class="pre">GiniHealth</span></code> does not have internet access when instantiated, or if it was instantiated
with a session manager without credentials, this method should be called when the SDK gains internet access (or session manager receives credentials).</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">trustMarkersFlow</span></code> depends on the loaded payment providers, so please make sure you call this method manually if your SDK instantiation is similar to the cases described above.</p>
</div>
</div>
<div class="section" id="upload-documents">
<h2><a class="toc-backref" href="#id2">Upload documents</a><a class="headerlink" href="#upload-documents" title="Permalink to this headline">¶</a></h2>
<p>Uploading documents is achieved via the <code class="docutils literal notranslate"><span class="pre">GiniHealthAPI</span></code> instance’s <code class="docutils literal notranslate"><span class="pre">documentManager</span></code>. You can access it by using the
<code class="docutils literal notranslate"><span class="pre">giniHealth.giniHealthAPI.documentManager</span></code> property.</p>
<p>For each document page a <em>partial document</em> needs to be created. The following example shows how to create a new partial
document from a byte array containing a JPEG image:</p>
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="c1">// Assuming `imageBytes` is an instance of a byte array containing a JPEG image,</span>
<span class="c1">// e.g. from a picture taken by the camera</span>

<span class="n">coroutineScope</span><span class="p">.</span><span class="n">launch</span> <span class="p">{</span>
    <span class="c1">// Create a partial document by uploading the document data</span>
    <span class="k">val</span> <span class="py">partialDocumentResource</span> <span class="p">=</span>
        <span class="n">giniHealth</span><span class="p">.</span><span class="n">giniHealthApi</span><span class="p">.</span><span class="n">documentManager</span><span class="p">.</span><span class="n">createPartialDocument</span><span class="p">(</span><span class="n">imageBytes</span><span class="p">,</span> <span class="s">&quot;image/jpeg&quot;</span><span class="p">,</span> <span class="s">&quot;document_page_1.jpg&quot;</span><span class="p">)</span>

    <span class="k">when</span> <span class="p">(</span><span class="n">partialDocumentResource</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="n">Resource</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="c1">// Use the partial document</span>
            <span class="k">val</span> <span class="py">partialDocument</span> <span class="p">=</span> <span class="n">partialDocumentResource</span><span class="p">.</span><span class="k">data</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="n">Resource</span><span class="p">.</span><span class="n">Error</span> <span class="p">-&gt;</span> <span class="c1">// Handle error</span>
        <span class="k">is</span> <span class="n">Resource</span><span class="p">.</span><span class="n">Cancelled</span> <span class="p">-&gt;</span> <span class="c1">// Handle cancellation</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>After all partial documents have been created you can create a <em>composite document</em> from the partials to bundle them
into one final document:</p>
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="c1">// Assuming `partialDocuments` is a list of `Documents` which were</span>
<span class="c1">// returned by `createPartialDocument(...)` calls</span>

<span class="n">coroutineScope</span><span class="p">.</span><span class="n">launch</span> <span class="p">{</span>
    <span class="c1">// Create a composite document by uploading the document data</span>
    <span class="k">val</span> <span class="py">compositeDocumentResource</span> <span class="p">=</span>
        <span class="n">giniHealth</span><span class="p">.</span><span class="n">giniHealthApi</span><span class="p">.</span><span class="n">documentManager</span><span class="p">.</span><span class="n">createCompositeDocument</span><span class="p">(</span><span class="n">partialDocuments</span><span class="p">)</span>

    <span class="k">when</span> <span class="p">(</span><span class="n">compositeDocumentResource</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="n">Resource</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="c1">// Use the composite document</span>
            <span class="k">val</span> <span class="py">compositeDocument</span> <span class="p">=</span> <span class="n">compositeDocumentResource</span><span class="p">.</span><span class="k">data</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="n">Resource</span><span class="p">.</span><span class="n">Error</span> <span class="p">-&gt;</span> <span class="c1">// Handle error</span>
        <span class="k">is</span> <span class="n">Resource</span><span class="p">.</span><span class="n">Cancelled</span> <span class="p">-&gt;</span> <span class="c1">// Handle cancellation</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="delete-multiple-documents-at-once">
<h2><a class="toc-backref" href="#id3">Delete multiple documents at once</a><a class="headerlink" href="#delete-multiple-documents-at-once" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">GiniHealthSDK</span></code> provides an easy method to delete multiple documents at once. You can call <code class="docutils literal notranslate"><span class="pre">giniHealth.deleteDocuments(...)</span></code> with the list of document
ids you want to delete. The call will only succeed if all documents were successfully deleted. If not all documents can be deleted, the whole call will fail
and no documents will be deleted. In the case of failures, an error or type <code class="docutils literal notranslate"><span class="pre">DeleteDocumentErrorResponse</span></code> will be provided, with more insight into why the deletion failed.</p>
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="c1">// Assuming `documentIds` is a list of `String` which</span>
<span class="c1">// represent the ids of the documents to be deleted</span>

<span class="n">coroutineScope</span><span class="p">.</span><span class="n">launch</span> <span class="p">{</span>
    <span class="c1">// Delete multiple documents at once</span>
    <span class="k">val</span> <span class="py">deleteDocuments</span> <span class="p">=</span> <span class="n">giniHealth</span><span class="p">.</span><span class="n">deleteDocuments</span><span class="p">(</span><span class="n">documentIds</span><span class="p">)</span>

    <span class="k">when</span> <span class="p">(</span><span class="n">deleteDocuments</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">is</span> <span class="n">Resource</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="c1">// `null` will be returned here</span>
        <span class="p">}</span>
        <span class="k">is</span> <span class="n">Resource</span><span class="p">.</span><span class="n">Error</span> <span class="p">-&gt;</span> <span class="c1">// Handle `DeleteDocumentErrorResponse`</span>
        <span class="k">is</span> <span class="n">Resource</span><span class="p">.</span><span class="n">Cancelled</span> <span class="p">-&gt;</span> <span class="c1">// Handle `DeleteDocumentErrorResponse`</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="check-which-documents-invoices-are-payable">
<h2><a class="toc-backref" href="#id4">Check which documents/invoices are payable</a><a class="headerlink" href="#check-which-documents-invoices-are-payable" title="Permalink to this headline">¶</a></h2>
<p>Call <code class="docutils literal notranslate"><span class="pre">giniHealth.checkIfDocumentIsPayable()</span></code> with the composite document id for each invoice to check whether it is
payable. We recommend performing this check only once right after the invoice has been uploaded and processed by Gini’s
Health API. You can then store the <code class="docutils literal notranslate"><span class="pre">isPayable</span></code> state in your own data model.</p>
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="c1">// Assuming `compositeDocument` is `Document` returned by `createCompositeDocument(...)`</span>

<span class="n">coroutineScope</span><span class="p">.</span><span class="n">launch</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="c1">// Check whether the composite document is payable</span>
        <span class="k">val</span> <span class="py">isPayable</span> <span class="p">=</span> <span class="n">giniHealth</span><span class="p">.</span><span class="n">checkIfDocumentIsPayable</span><span class="p">(</span><span class="n">compositeDocument</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">e</span><span class="p">:</span> <span class="n">Exception</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Handle error</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="check-if-document-has-multiple-invoices">
<h2><a class="toc-backref" href="#id5">Check if document has multiple invoices</a><a class="headerlink" href="#check-if-document-has-multiple-invoices" title="Permalink to this headline">¶</a></h2>
<p>Call <code class="docutils literal notranslate"><span class="pre">giniHealth.checkIfDocumentContainsMultipleDocuments()</span></code> with the composite document id to check whether it contains multiple invoices or not.
We recommend performing this check after checking if the document is payable. The method will return <code class="docutils literal notranslate"><span class="pre">true</span></code> if the document contains
multiple invoices, <code class="docutils literal notranslate"><span class="pre">false</span></code> if otherwise.</p>
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="c1">// Assuming `compositeDocument` is `Document` returned by `createCompositeDocument(...)`</span>

<span class="n">coroutineScope</span><span class="p">.</span><span class="n">launch</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="c1">// Check whether the composite document contains multiple invoices</span>
        <span class="k">val</span> <span class="py">containsMultipleInvoices</span> <span class="p">=</span> <span class="n">giniHealth</span><span class="p">.</span><span class="n">checkIfDocumentContainsMultipleDocuments</span><span class="p">(</span><span class="n">compositeDocument</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">e</span><span class="p">:</span> <span class="n">Exception</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Handle error</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="create-the-paymentfragment">
<h2><a class="toc-backref" href="#id6">Create the PaymentFragment</a><a class="headerlink" href="#create-the-paymentfragment" title="Permalink to this headline">¶</a></h2>
<p>For creating in instance of <code class="docutils literal notranslate"><span class="pre">PaymentFragment</span></code> for payments with a <code class="docutils literal notranslate"><span class="pre">documentId</span></code> you should use the
<code class="docutils literal notranslate"><span class="pre">getPaymentFragmentWithDocument</span></code> method provided by  <code class="docutils literal notranslate"><span class="pre">GiniHealth</span></code>. It should be added to your hierarchy, and will
handle the payment flow internally.</p>
<p>You need to pass in the <code class="docutils literal notranslate"><span class="pre">documentId</span></code> and, optionally, an instance of <code class="docutils literal notranslate"><span class="pre">PaymentFlowConfiguration</span></code>.</p>
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">getPaymentFragmentWithDocument</span><span class="p">(</span><span class="n">documentId</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span> <span class="n">paymentFlowConfiguration</span><span class="p">:</span> <span class="n">PaymentFlowConfiguration</span><span class="p">?):</span> <span class="n">PaymentFragment</span>
</pre></div>
</div>
<p>An instance of <code class="docutils literal notranslate"><span class="pre">PaymentFragment</span></code> can also be created without a <code class="docutils literal notranslate"><span class="pre">documentId</span></code> by calling the <code class="docutils literal notranslate"><span class="pre">getPaymentFragmentWithoutDocument</span></code>
method provided by <code class="docutils literal notranslate"><span class="pre">GiniHealth</span></code>.</p>
<p>You need to pass the payment details as parameter to the method:</p>
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">getPaymentFragmentWithoutDocument</span><span class="p">(</span><span class="n">paymentDetails</span><span class="p">:</span> <span class="n">PaymentDetails</span><span class="p">,</span> <span class="n">paymentFlowConfiguration</span><span class="p">:</span> <span class="n">PaymentFlowConfiguration</span><span class="p">?):</span> <span class="n">PaymentFragment</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Currently, We support <code class="docutils literal notranslate"><span class="pre">amount</span></code> which is passed in <code class="docutils literal notranslate"><span class="pre">PaymentDetails</span></code> in the format 12345.67, meaning up to five digits before the decimal and two digits after the decimal. The maximum allowed amount is 99999.99.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">PaymentFragment</span></code> handles the navigation for the screens shown during the payment flow. It doesn’t handle external navigation related events and doesn’t show a navigation bar. You are
free to design navigation to and from the fragment as you see fit.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">PaymentFlowConfiguration</span></code> class contains the following options:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">shouldHandleErrorsInternally</span></code>: If set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, the <code class="docutils literal notranslate"><span class="pre">PaymentFragment</span></code> will handle errors internally and show
snackbars for errors. If set to <code class="docutils literal notranslate"><span class="pre">false</span></code>, errors will be ignored by the <code class="docutils literal notranslate"><span class="pre">PaymentFragment</span></code>. In this case the flows
exposed by <code class="docutils literal notranslate"><span class="pre">GiniHealth</span></code> should be observed for errors. Default value is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">showCloseButtonOnReviewFragment</span></code>: If set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, a floating close button will be shown in the top right corner of the screen. This parameter is used only for payments started with a <code class="docutils literal notranslate"><span class="pre">documentId</span></code>. Default value is <code class="docutils literal notranslate"><span class="pre">false</span></code>.</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">shouldShowReviewBottomDialog</span></code>: If set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, the <code class="docutils literal notranslate"><span class="pre">PaymentFragment</span></code> will show a bottom sheet dialog containing the payment details. If set to <code class="docutils literal notranslate"><span class="pre">false</span></code>, the payment details will not be visible during the payment flow. They will be available to be reviewed after redirecting to the selected payment provider,</dt>
<dd>before finalizing the payment. This parameter is only used in the case of payment flows started without <code class="docutils literal notranslate"><span class="pre">documentId</span></code>.
Default value is <code class="docutils literal notranslate"><span class="pre">false</span></code></dd>
</dl>
</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">As the SDK is not responsible for navigation flows outside of it, removing the payment fragment from the hierarchy is the responsibility of implementers at <code class="docutils literal notranslate"><span class="pre">PaymentState.Success(paymentRequest)</span></code> or <code class="docutils literal notranslate"><span class="pre">PaymentState.Cancel()</span></code> events.</p>
</div>
<div class="highlight-kotlin notranslate"><div class="highlight"><pre><span></span><span class="n">giniHealth</span><span class="p">.</span><span class="n">openBankState</span><span class="p">.</span><span class="n">collect</span> <span class="p">{</span> <span class="n">paymentState</span> <span class="p">-&gt;</span>
     <span class="k">when</span> <span class="p">(</span><span class="n">paymentState</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">is</span> <span class="n">GiniHealth</span><span class="p">.</span><span class="n">PaymentState</span><span class="p">.</span><span class="n">Success</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="p">...</span>
            <span class="c1">// Remove fragment from view hierarchy</span>
         <span class="p">}</span>
         <span class="k">is</span> <span class="n">GiniHealth</span><span class="p">.</span><span class="n">PaymentState</span><span class="p">.</span><span class="n">Cancel</span> <span class="p">-&gt;</span> <span class="p">{</span>
            <span class="c1">// Remove fragment from view hierarchy</span>
         <span class="p">}</span>
         <span class="k">else</span> <span class="p">-&gt;</span> <span class="p">{}</span>
     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="event-tracking.html" class="btn btn-neutral float-right" title="Event Tracking">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="authentication.html" class="btn btn-neutral" title="Authentication"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    </p>
  </div>
</footer>
        </div>
      </div>

    </section>

  </div>
  

  
</body>
</html>